# filepath: /Users/nolson/hap.py-update-take2/hap.py/tox.ini
[tox]
min_version = 4.0
env_list =
    py38
    py39
    py310
    py311
    lint

[testenv]
deps =
    pytest>=6.0
    pytest-cov>=2.12.0
commands =
    pytest tests/unit -v {posargs}
    # Integration tests require C++ components, so run them conditionally
    python -c "import os; os.system('pytest tests/integration -v {posargs}') if os.path.exists('build/bin/hapcmp') else print('Skipping integration tests - C++ components not built')"

[testenv:lint]
deps =
    black
    ruff
    isort
    mypy
commands =
    black --check src/python
    ruff check src/python
    isort --check src/python
    mypy src/python

[testenv:build]
deps =
    build
    twine
skip_install = true
commands =
    python -m build
    twine check dist/*
